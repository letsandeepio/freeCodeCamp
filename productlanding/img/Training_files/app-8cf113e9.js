"use strict";function Cards(e,t,r,o,a){function n(e){return c=Date.now(),e?angular.toJson(e):e}function i(){var e=new Date;return e.setHours(23,59,59,999),e}function u(e){var t=i();return t.setDate(t.getDate()-e),t}var s=t.urls.svcBase+"/opslink/cards/:id",c=Date.now(),l=e(s,{id:"@id"},{query:{method:"GET",isArray:!0,params:{targets:["CARD_STREAM"],_:function(){return c}}},save:{url:s,method:"POST",transformRequest:n},get:{method:"GET",url:s},like:{url:s+"/like",method:"POST",transformRequest:n},unlike:{url:s+"/unlike",paramDefaults:{id:"@id"},method:"POST",transformRequest:n},"delete":{url:s,method:"DELETE",transformRequest:n}});this.get=function(e){return l.get(e)},this.query=function(e){e=e||{};var t=e.offset||0,r=e.days||1;return l.query({startDateLong:e.startDateLong||u(t+r).getTime(),endDateLong:e.endDateLong||u(t).getTime(),locationId:e.locationId})},this.queryInitial=function(e,t){e=e||{};var o=e.minCards||5,a=e.maxDays||7,n=0,i=[],u=0,s=this,c=r(function(r,c){!function l(){s.query({offset:n,locationId:e.locationId}).$promise.then(function(e){u+=e.length,i[n++]=t?e.filter(t):e,o>u&&a>n?l():r(i)}).catch(function(e){c(e)})}()});return{$promise:c}},this.save=function(e,t){return l.save(e,t)},angular.extend(l.prototype,{$fwComment:o(s,function(e){return n(e),{id:e.id}}),$fwMediaLinkFactory:a(s,function(e){return n(e),{id:e.id}})})}function Queue(){var e=[],t=0;this.enqueue=function(t){e.push(t)},this.enqueueArr=function(t){t.forEach(function(t){e.push(t)})},this.dequeue=function(){if(0==e.length)return null;var r=e[t];return 2*++t>=e.length&&(e=e.slice(t),t=0),r},this.isEmpty=function(){return e.length<1}}function MediaDeleteQueue(e,t){var r={};this.createIntent=function(e,t,o,a,n){if(a=a||"entityId",r[t])return void delete r[t];var i={};i[a]=e,i.mediaId=t,n&&angular.extend(i,n),r[t]=o.bind(null,i)},this.fulFillIntents=function(){var e={};return angular.forEach(r,function(t,r){t&&(e[r]=t())}),t.all(e)},this.hasPendingIntent=function(){return Object.keys(r).length>0}}function MandatoryCardsService(e){var t={},r=[],o=0,a=e.$new(),n=a.$new(),i={event:{},survey:{}};this.registerListener=function(e){return t[o]=e,o++&&o},this.degisterListener=function(e){delete t[e]},this.callListeners=function(e){angular.forEach(t,function(t){t&&t(r,e)})},this.addMandatoryCard=function(e,t){var o=e[e.what].id;i[e.what][o]||(r.push(e),i[e.what][o]=1,this.callListeners(t))},this.$on=function(){a.$on.apply(a,arguments)},this.$emit=function(){n.$emit.apply(n,arguments)},this.$broadcast=function(){a.$broadcast(arguments)},this.$destroy=function(){n.$destroy(),a.$destroy()}}function DesireQueue(e){function t(e){a.push(e)}function r(){console.log("desires being fulfilled");var t=e.defer();if(0===a.length)return t.resolve(!0),t.promise;var o=a.shift();return o().then(r)}function o(){return a.length>0}var a=[];return{addDesire:t,fulFillDesires:r,hasPendingDesire:o}}angular.module("fw-common",["ng.deviceDetector","fw-core","angulartics","angulartics.google.analytics"]).config(["fw.common.GoogleAnalyticsProvider","$fwConfigProvider","$analyticsProvider",function(e,t,r){var o=t.$get(),a=!o.sysParams.hasOwnProperty("ga.tracking.id")||null===o.sysParams["ga.tracking.id"]&&""===o.sysParams["ga.tracking.id"]?null:o.sysParams["ga.tracking.id"];a&&e.create(a),r.virtualPageviews(!1),r.settings.pageTracking.autoTrackFirstPage=!1}]).run(["$rootScope","$analytics","$location","$window","$fwConfig",function(e,t,r,o,a){e.$on("$stateChangeSuccess",function(e,n){function i(e){var t=r.protocol()+"://"+r.host(),o=e.substring(t.length);return":"===o[0]&&(o=e.substring(t.length+r.port().toString().length+1)),o}function u(){var e=!1;return o.performance&&1==o.performance.navigation.type&&(e=!0),e}function s(){return n.hasOwnProperty("abstract")?n.abstract===!0:!1}function c(){return n.hasOwnProperty("data")&&n.data.hasOwnProperty("doNotTrackGA")?!0:!1}function l(){return u()?!1:s()?!1:c()?!1:!0}var d=a.sysParams.hasOwnProperty("ga.tracking.id")&&(null!==a.sysParams["ga.tracking.id"]||""!==a.sysParams["ga.tracking.id"]);d&&l()&&t.pageTrack(i(r.absUrl()))})}]),angular.module("fw-common").factory("$fw.common.tasks.taskSchedule",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/task/:taskId/schedule/:taskScheduleId",o=e(r,{taskId:"@taskId",taskScheduleId:"@taskScheduleId"},{update:{method:"PUT",url:r}});return o}]),angular.module("fw-common").factory("$fw.common.resource.TaskPriority",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/task/looktaskpriority",o={},a={};return e(r,o,a)}]),angular.module("fw-common").factory("$fw.common.resource.TaskOwner",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/task/looktaskowner",o={},a={};return e(r,o,a)}]),angular.module("fw-common").factory("$fw.common.resource.Task",["$resource","$fwConfig","$fw.common.rest.mediaLinkFactory","$fw.common.rest.locationFilterFactory",function(e,t,r,o){var a=t.urls.svcBase+"/task/:id",n={id:"@id"},i={update:{method:"PUT"},getAllLookTasks:{method:"GET",isArray:!0,url:t.urls.svcBase+"/task?all=true"}},u=e(a,n,i);return angular.extend(u.prototype,{$fwLocationFilter:o(a),$fwMediaLinkFactory:r(a)}),u}]),angular.module("fw-common").factory("$fw.common.resource.TaskCategory",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/task/looktaskcategory",o={},a={};return e(r,o,a)}]),angular.module("fw-common").factory("$fw.common.rest.lookTaskActions",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/task/looktaskaction",o={cd:"@cd",statusCd:"@statusCd"},a={findByCd:{method:"GET",url:r+"/:cd",isArray:!0},findByStatus:{method:"GET",url:r+"/status/:statusCd",isArray:!0}};return e(r,o,a)}]),angular.module("fw-common").factory("$fw.common.rest.lookRoutineTimeSlot",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/routine/timeslot",o={},a={};return e(r,o,a)}]),angular.module("fw-common").factory("$fw.common.resource.survey",["$resource","$fwConfig","$fw.common.rest.locationFilterFactory",function(e,t,r){var o=t.urls.svcBase+"/opslink/quicksurvey/:id",a=o+"/choice/:choiceId",n=o+"/response",i=n+"/user/:userId",u=t.urls.svcBase+"/opslink/quicksurvey/card/:cardId/survey/:id",s=e(o,{id:"@id",choiceId:"@choiceId",userId:"@userId"},{query:{method:"GET",isArray:!0,url:o+"/find",interceptor:{response:function(e){return e.resource._searchMeta=e.data._searchMeta,e.resource}}},update:{method:"PUT"},getChoices:{method:"GET",isArray:!0,url:a},deleteChoice:{method:"DELETE",url:a},getChoice:{method:"GET",isArray:!1,url:a},updateChoice:{method:"PUT",isArray:!1,url:a},addChoice:{method:"POST",isArray:!1,url:a},postResponse:{method:"POST",isArray:!1,url:n},getResponse:{method:"GET",isArray:!1,url:n},getUserResponse:{method:"GET",isArray:!1,url:i},getForCard:{url:u,isArray:!1,method:"GET"}});return angular.extend(s.prototype,{$fwLocationFilter:r(o)}),s}]),angular.module("fw-common").service("$fw.opslink.rest.cards",["$resource","$fwConfig","$q","$fw.common.rest.commentFactory","$fw.common.rest.mediaLinkFactory",Cards]),angular.module("fw-common").factory("$fw.templogs.approve",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/temperaturelog",o=r+"/:logId/approve",a=r+"/multi/approve",n=e(r,{logId:"@logId"},{approve:{method:"POST",url:o,isArray:!1},multiApprove:{method:"POST",url:a,isArray:!1},query:{url:o,isArray:!1}});return n}]),angular.module("fw-common").factory("$fw.routine.templog.rest.tempLogAction",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/temperaturelog/:logId/actions/:actionId",o=e(r,{logId:"@logId",actionId:"@actionId"},{update:{method:"PUT"},mapActions:{method:"GET",url:t.urls.svcBase+"/temperaturelog/:logId/actions/map"}});return o}]),angular.module("fw-common").factory("$fw.routine.log.rest.logAction",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log/:logId/actions/:actionId",o=e(r,{logId:"@logId",actionId:"@actionId"},{update:{method:"PUT"},mapActions:{method:"GET",url:t.urls.svcBase+"/log/:logId/actions/map"}});return o}]),angular.module("fw-common").factory("$fw.logs.rest.adhocLog",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/routine",o=r+"/adhocLog/create",a=e(r,{locationId:"@locationId",dateInt:"@dateInt",logRefId:"@logRefId"},{createLog:{method:"POST",url:o,isArray:!1}});return a}]),angular.module("fw-common").factory("$fw.common.rest.lookUnitOfMeasure",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/lookuom",o=e(r,{});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookTempLogCategory",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log/looktemplogcategory",o=e(r,{typeCd:"@typeCd"},{byCode:{method:"GET",url:r+"/type/:typeCd",isArray:!0},getAll:{method:"GET",isArray:!0}});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookLog",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log/look",o=e(r,{},{update:{method:"PUT"}});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookLogAttribute",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/looklogattribute/:id",o=e(r,{id:"@id"});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookEquipmentCalibrationSet",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/lookequipment/:equipmentId/calibrationsets",o=e(r,{equipmentId:"@equipmentId",locationCd:"@locationCd"},{query:{method:"GET",isArray:!0}});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookCalibrationSet",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/equipment/lookcalibrationset",o=e(r,{},{query:{method:"GET",isArray:!0}});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookCalibrationCategoryEquipment",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log/lookcalibrationcategory/equipment",o=e(r,{},{query:{method:"GET",isArray:!0,cache:!0}});return o}]),angular.module("fw-common").factory("$fw.logs.rest.log",["$resource","$fwConfig","$fw.common.rest.commentFactory","$fw.core.httpPaginationInterceptor",function(e,t,r,o){var a=t.urls.svcBase+"/log/:logId",n=a+"/attribute",i=a+"/complete",u=a+"/find",s=a+"/export",c=t.urls.svcBase+"/log/category",l=e(a,{logId:"@logId"},{update:{method:"PUT",url:n,isArray:!0,headers:{"X-ClientRequestTime":function(e){var t=Date.now();if(e&&e.data)if("string"==typeof e.data){var r=e.data.indexOf(", 'time':"),o=e.data,a="";if(r>=0){if(o=e.data.substring(0,r),a=e.data.substring(r+9,e.data.length),""!=a){var n=parseInt(a);isNaN(n)||(t=n)}e.data=o}}else e.data.time&&(t=e.data.time,delete e.data.time);return t}}},updateCategories:{method:"PUT",url:c,isArray:!0,headers:{"X-ClientRequestTime":function(e){var t=Date.now();if(e&&e.data)if("string"==typeof e.data){var r=e.data.indexOf(", 'time':"),o=e.data,a="";if(r>=0){if(o=e.data.substring(0,r),a=e.data.substring(r+9,e.data.length),""!=a){var n=parseInt(a);isNaN(n)||(t=n)}e.data=o}}else e.data.time&&(t=e.data.time,delete e.data.time);return t}}},getAttributes:{method:"GET",url:n,isArray:!0},complete:{method:"PUT",url:i,headers:{"X-ClientRequestTime":function(e){var t=Date.now();if(e&&e.data){var r=e.data;"string"==typeof e.data?(r=JSON.parse(e.data),r&&r.time&&(t=r.time,delete r.time,e.data=JSON.stringify(r))):e.data.time&&(t=e.data.time,delete e.data.time)}return t}}},query:{url:u,isArray:!0,interceptor:{response:o.response}},generateExcel:{method:"GET",header:{accept:"application/vnd.ms-excel"},withCredentials:!0,responseType:"arraybuffer",transformResponse:function(e){var t,r=document.createElement("a");if(document.body.appendChild(r),e){t=new Blob([e],{type:"application/vnd.ms-excel"});var o=function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")};if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,"export.xls");else if(o()){var a="data:application/vnd.ms-excel;charset=UTF-8;base64,",n=a+btoa(String.fromCharCode.apply(null,new Uint8Array(e)));r.href=n,r.download="export.xls",r.click()}else{var n=window.URL.createObjectURL(t);r.href=n,r.download="export.xls",r.click(),window.URL.revokeObjectURL(n)}}return{response:t}},url:s}});return angular.extend(l.prototype,{$fwComment:r(a,function(e){return{logId:e.id}})}),l}]),angular.module("fw-common").factory("$fw.logs.category.rest.log",["$resource","$fwConfig","$fw.common.rest.commentFactory","$fw.core.httpPaginationInterceptor",function(e,t,r){var o=t.urls.svcBase+"/log/:logId/category/:id",a=e(o,{logId:"@logId",id:"@id"});return angular.extend(a.prototype,{$fwComment:r(o,function(e){return{id:e.id}})}),a}]),angular.module("fw-common").factory("$fw.logs.approve",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log",o=r+"/:logId/approve",a=r+"/multi/approve",n=e(r,{logId:"@logId"},{approve:{method:"POST",url:o,isArray:!1},multiApprove:{method:"POST",url:a,isArray:!1},query:{url:o,isArray:!1}});return n}]),angular.module("fw-common").factory("$fw.logs.rest.logAction",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/logattributes/:attributeId/actions/:actionId",o=e(r,{attributeId:"@attributeId",actionId:"@actionId"},{update:{method:"PUT"},mapActions:{method:"GET",url:t.urls.svcBase+"/logattributes/attribute/actions/map/:attributeIds"},mapActionsUser:{method:"GET",url:t.urls.svcBase+"/userlog/attribute/actions/map/:attributeIds"}});return o}]),angular.module("fw-common").factory("$fw.routine.templog.rest.calibrationLogAction",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/calibrationlog/:logId/actions",o={update:{method:"PUT"},link:{method:"POST",url:t.urls.svcBase+"/calibrationlog/:logId/actions/:actionId"},get:{method:"GET",url:t.urls.svcBase+"/calibrationlog/:logId/actions",isArray:!0}},a=e(r,{logId:"@logId",actionId:"@actionId"},o);return a}]),angular.module("fw-common").factory("$fw.routine.templog.rest.calibrationLogEntryAction",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/calibrationlogentries/:logId/actions/:entryId",o={update:{method:"PUT"},link:{method:"POST",url:t.urls.svcBase+"/calibrationlogentries/:entryId/actions/:actionId"},mapActions:{method:"GET",url:t.urls.svcBase+"/calibrationlogentries/:logId/actions/map/:entryIds"}},a=e(r,{logId:"@logId",actionId:"@actionId",entryIds:"@entryIds",entryId:"@entryId"},o);return a}]),angular.module("fw-common").factory("$fw.location.locationGroup.rest",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/locationgroup/:id",o=t.urls.svcBase+"/locationgroup/find",a=e(r,{id:"@id"},{search:{method:"GET",isArray:!0,url:o}});return a}]),angular.module("fw-common").factory("$fw.common.lookAttributes",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/location/lookdayattribute",o=e(r,{},{query:{isArray:!0}});return o}]),angular.module("fw-common").factory("$fw.common.location.day.attributes",["$resource","$fwConfig","$fw.location.schedule.utilities",function(e,t){var r=t.urls.svcBase+"/location/:id/schedule/:day/attribute",o=e(r,{locationId:"@locationId",day:"@day"},{query:{isArray:!0},update:{method:"PUT",isArray:!0,transformRequest:function(e){var t=[];return e&&e.attributes.forEach(function(r){return r.selected&&(delete r.selected,t.push({locationDayScheduleId:e.locationDayScheduleId,dayAttributeCd:r.cd,description:r.name})),r}),angular.toJson(t)}},"delete":{method:"DELETE"}});return o}]),angular.module("fw-common").factory("$fw.scoring.rest",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/scoring/userlog/:logId",o=e(r,{logId:"@logId"},{});return o}]),angular.module("fw-common").factory("$fw.foundations.rest.js",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/foundation/user/:userId",o=r+"/evaluation/:shiftCd",a=o+"/attributes",n=o+"/actions/:actionId",i=e(r,{userId:"@userId",shiftCd:"@shiftCd",actionId:"@actionId"},{getEvals:{method:"GET",isArray:!0,url:r+"/evaluation/"},deleteEval:{method:"DELETE",isArray:!1,url:o},getEval:{method:"GET",isArray:!1,url:o},updateAttr:{method:"PUT",isArray:!1,url:a},completeEval:{method:"PUT",isArray:!1,url:o},updateAction:{method:"POST",url:n},getActions:{method:"GET",url:n,isArray:!0}});return i}]),angular.module("fw-common").factory("$fw.common.resolution",["$q","$fw.common.rest.resolution",function(e,t){var r=this,o=function(r){var o=e.defer(),a="$save";r.media&&r.media.length>0&&(a="$saveWithMedia");var n=new t(r);return n[a]().then(function(e){o.resolve(e)},function(){console.log("resolution save failed"),o.reject()}),o.promise},a=function(r){var o=e.defer(),a="$update";r.media&&r.media.length>0&&(a="$updateWithMedia"),r.mediaLinks&&delete r.mediaLinks;var n=new t(r);return n[a]().then(function(e){o.resolve(e)},function(){console.log("resolution save failed"),o.reject()}),o.promise};return angular.extend(r,{save:o,update:a}),r}]),angular.module("fw-common").factory("$fw.common.rest.resolution",["$resource","$fwConfig",function(e,t){function r(e){var t=new FormData;if(t.append("content",JSON.stringify(e)),e.media&&e.media.length>0)for(var r=0;r<e.media.length;r++)e.media[r].blob?t.append("media",e.media[r].blob,e.media[r].filename):t.append("media",e.media[r]),e.media[r].caption=e.media[r].caption||e.media[r].filename;return t}var o=t.urls.svcBase+"/service/actions/items/:id/resolution/:resolutionId",a=e(o,{id:"@actionId",resolutionId:"@id"},{query:{isArray:!0},update:{method:"PUT"},updateWithMedia:{method:"POST",transformRequest:function(e){var t=angular.copy(e);return t.auditProps=void 0,t.resolution=void 0,t.media=e.media,r(t)},headers:{"Content-Type":void 0}},"delete":{method:"DELETE"},pull:{isArray:!1},save:{method:"POST",headers:{"Content-Type":"application/json"}},saveWithMedia:{method:"POST",transformRequest:r,headers:{"Content-Type":void 0}}});return a}]),angular.module("fw-common").factory("$fw.common.payload-config",[function(){function e(e){return{actionPayload:e,resolutionPayload:r}}function t(t){var r=a[t];return r=r||n[t],r=r||e(t)}var r="frameworks.eap.data.payload.TextResolutionPayload",o=[{actionPayload:"frameworks.eap.data.payload.TextActionPayload",resolutionPayload:"frameworks.eap.data.payload.TextResolutionPayload"}],a={},n={};return o.forEach(function(e){a[e.actionPayload]=e,n[e.resolutionPayload]=e}),{getConfigByPayload:t}}]),angular.module("fw-common").service("$fw.common.actions-selectors",["$filter",function(e){var t=this;t.severity=["CRITICAL","SIGNIFICANT","MINOR"],t.resolution=[{val:!0,msgCode:e("translate")("eap.label.resolved")},{val:!1,msgCode:e("translate")("eap.label.unresolved")}],t.resolutionWithin=[8,24,48,168,672]}]),angular.module("fw-common").factory("$fw.common.rest.actions",["$resource","$fwConfig","$fw.common.rest.mediaLinkFactory",function(e,t,r){function o(e){var t=new FormData;if(t.append("content",JSON.stringify(e)),e.media&&e.media.length>0)for(var r=0;r<e.media.length;r++)e.media[r].blob?t.append("media",e.media[r].blob,e.media[r].filename):t.append("media",e.media[r]),e.media[r].caption=e.media[r].caption||e.media[r].filename;return t}var a=t.urls.svcBase+"/service/actions/items/:id",n=a+"/export/",i=e(a,{id:"@id"},{query:{isArray:!0},generateExcel:{method:"GET",header:{accept:"application/vnd.ms-excel"},responseType:"arraybuffer",transformResponse:function(e){var t,r=document.createElement("a");if(document.body.appendChild(r),e){t=new Blob([e],{type:"application/vnd.ms-excel"});var o=window.URL.createObjectURL(t);r.href=o,r.download="export.xls",r.click(),window.URL.revokeObjectURL(o)}return{response:t}},url:n},update:{method:"PUT"},updateWithMedia:{method:"POST",transformRequest:function(e){var t=angular.copy(e);return t.auditProps=void 0,t.resolution=void 0,t.media=e.media,o(t)},headers:{"Content-Type":void 0}},"delete":{method:"DELETE"},pull:{isArray:!1},save:{method:"POST",headers:{"Content-Type":void 0,"X-ClientRequestTime":function(e){var t=Date.now();if(e&&e.data){var r=e.data;"string"==typeof e.data?(r=JSON.parse(e.data),r&&r.time&&(t=r.time,delete r.time,e.data=JSON.stringify(r))):e.data.time&&(t=e.data.time,delete e.data.time)}return t}}},saveWithMedia:{method:"POST",transformRequest:o,headers:{"Content-Type":void 0}}});return angular.extend(i.prototype,{$fwMediaLinkFactory:r(a)}),i}]),angular.module("fw-common").service("$fw.common.actions-create",["$q","$fw.common.rest.actions",function(e,t){function r(r,o){var a=new t({"@class":"frameworks.eap.data.LocationActionItem",actionSource:"EAP",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],media:[],payload:{"@class":r,actionText:null},payloadType:r,locationId:null});angular.extend(a,o);var n=e.defer();return n.resolve(a),n.promise}function o(e){return angular.extend({"@class":"frameworks.eap.data.LocationActionItem",actionSource:"EAP",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],media:[],payload:{"@class":"frameworks.eap.data.payload.TextActionPayload",actionText:null},payloadType:"frameworks.eap.data.payload.TextActionPayload",locationId:null},e)}function a(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.LogAttributeActionPayload",actionText:null,lookLogAttributeId:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.LogAttributeActionPayload",locationId:null};return angular.merge(t,e),t}function n(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.MWTLogAttributeActionPayload",actionText:null,lookLogAttributeId:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.MWTLogAttributeActionPayload",locationId:null};return angular.merge(t,e),t}function i(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.RoutineLogActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.RoutineLogActionPayload",locationId:null};return angular.merge(t,e),t}function u(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.MWTRoutineLogActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.MWTRoutineLogActionPayload",locationId:null};return angular.merge(t,e),t}function s(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.QualityCheckTemperatureLogEntryActionPayload",actionText:null,lookEquipmentId:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.QualityCheckTemperatureLogEntryActionPayload",locationId:null};return angular.merge(t,e),t}function c(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.CookOutTemperatureLogEntryActionPayload",actionText:null,lookMenuItemId:null,logId:null},mediaLinks:[],payloadType:"frameworks.eap.data.payload.CookOutTemperatureLogEntryActionPayload",locationId:null};return angular.merge(t,e),t}function l(e){var t={"@class":"frameworks.eap.data.UserActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.TextActionPayload",actionText:null},mediaLinks:[],payloadType:"frameworks.eap.data.payload.TextActionPayload",userId:null};return angular.merge(t,e),t}function d(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.HoldingTemperatureLogActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.HoldingTemperatureLogActionPayload",locationId:null};return angular.merge(t,e),t}function m(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.ReceivingTemperatureLogActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.ReceivingTemperatureLogActionPayload",locationId:null};return angular.merge(t,e),t}function f(e){if(null==e||void 0===e)return o(arguments.length>1?arguments[1]:void 0);var t=y[e],a=[];if(t){for(var n=1;n<arguments.length;n++)a.push(arguments[n]);return t.call(v,a)}for(var i=0;i<arguments.length;i++)a.push(arguments[i]);return r.apply(v,arguments)}function g(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.RoutineCalibrationLogActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.RoutineCalibrationLogActionPayload",locationId:null};return angular.merge(t,e),t}function p(e){var t={"@class":"frameworks.eap.data.LocationActionItem",actionSource:"Log",severity:null,resolutionWithin:null,status:"ACTIVE",visibility:[],payload:{"@class":"frameworks.eap.data.payload.EquipmentCalibrationLogEntryActionPayload",actionText:null,logId:null},media:[],mediaLinks:[],payloadType:"frameworks.eap.data.payload.EquipmentCalibrationLogEntryActionPayload",locationId:null};return angular.merge(t,e),t}var y={},v={};return y["frameworks.action.data.payload.TextActionPayload"]=o,y["frameworks.eap.data.payload.LogAttributeActionPayload"]=a,y["frameworks.eap.data.payload.MWTLogAttributeActionPayload"]=n,y["frameworks.eap.data.payload.RoutineLogActionPayload"]=i,y["frameworks.eap.data.payload.MWTRoutineLogActionPayload"]=u,y["frameworks.eap.data.payload.QualityCheckTemperatureLogEntryActionPayload"]=s,y["frameworks.eap.data.payload.CookOutTemperatureLogEntryActionPayload"]=c,y["frameworks.eap.data.UserActionItem"]=l,y["frameworks.eap.data.payload.HoldingTemperatureLogActionPayload"]=d,y["frameworks.eap.data.payload.ReceivingTemperatureLogActionPayload"]=m,y["frameworks.eap.data.payload.RoutineCalibrationLogActionPayload"]=g,y["frameworks.eap.data.payload.EquipmentCalibrationLogEntryActionPayload"]=p,angular.extend(v,{createTextAction:o,createByPayload:f,createTemperatureCookoutActionPayload:c,createTemperatureQualityCheckActionPayload:s,createRoutineLogActionPayload:i,createHoldingTemperatureLogActionPayload:d,createLogAttributeActionPayload:a,createUserLogActionPayload:l,createMWTLogAttributeActionPayload:n,createMWTRoutineLogActionPayload:u,createReceivingTemperatureLogActionPayload:m,createCalibrationLogActionPayload:g,createCalibrationLogEntryActionPayload:p}),v}]),angular.module("fw-common").factory("$fw.common.action",["$q","$fw.common.rest.actions","$fw.common.resolution","$filter",function(e,t,r,o){function a(e){for(var t=e.slice(),r={},a=[],n=0;n<e.length;++n)for(var i=n+1;i<e.length;++i)e[n].payloadType===e[i].payloadType&&e.splice(i--,1);for(var u=0;u<e.length;u++){r.bucket={name:o("translate")(e[u].payloadType?e[u].payloadType:"eap.label.other"),list:[]};for(var s=0;s<t.length;s++)t[s].payloadType===e[u].payloadType&&r.bucket.list.push(t[s]);a.push(r.bucket)}return a}function n(e){var t=i(new Date),r=[{cd:o("translate")("eap.label.PAST_DUE"),maxDate:t},{cd:o("translate")("eap.label.TODAY"),maxDate:u(t,1)},{cd:o("translate")("eap.label.TOMORROW"),maxDate:u(t,2)},{cd:o("translate")("eap.label.SHORT_TERM"),maxDate:u(t,8)},{cd:o("translate")("eap.label.LONG_TERM"),maxDate:null}],a=[],n={};return r.forEach(function(e){var t={name:e.cd,list:[]};a.push(t),n[e.cd]=t}),e.forEach(function(e){for(var t=i(new Date(e.dueDate)),o=0;o<r.length;o++){var a=r[o];if(null==a.maxDate||t.getTime()<a.maxDate.getTime()){n[a.cd].list.push(e);break}}}),a}function i(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function u(e,t){var r=new Date(e);return r.setDate(e.getDate()+t),r}var s,c=this,l=function(r){var o=null,a={},n=e.defer();return r&&angular.extend(a,r),t.query(a,function(e,t){o=t();var r={headers:o,results:e};n.resolve(r)}),n.promise},d=function(r,o,a){var n="$save";a&&(r.time=a),r.media&&r.media.length>0&&(n="$saveWithMedia");var i={};o&&angular.extend(i,{logId:o});var u=e.defer(),s=new t(r);return s[n](i).then(function(e){c.actions.list.push(s),c.actions.bucketFn&&(c.actions.buckets=c.actions.bucketFn(c.actions.list)),u.resolve(e)},function(){console.log("fails"),u.reject()}),u.promise},m=function(t,o){var a=e.defer(),n="$update";return t.media&&t.media.length>0&&(n="$updateWithMedia"),t.hasOwnProperty("_searchMeta")&&delete t._searchMeta,t[n]().then(function(e){o.hasOwnProperty("_searchMeta")&&delete o._searchMeta,o.id?r.update(o).then(function(t){e.resolution=t,a.resolve(e)}):r.save(o).then(function(t){e.resolution=t,a.resolve(e)})},function(e){a.reject(e)}),a.promise},f=function(e){return t.get({id:e}).$promise},g=function(r){var o=null,n={locationId:s,isResolved:"false",target:"EAP"};r&&angular.extend(n,r);var i=e.defer();return t.query(n,function(e,t){o=t()}).$promise.then(function(e){c.actions.list=e,c.actions.bucketFn=a,c.actions.buckets=a(e),i.resolve()},function(e){console.log("ERROR-> ",e),i.reject()}),i.promise},p=function(r){var o=null,a={locationId:s,isResolved:"false",target:"EAP"};r&&angular.extend(a,r);var i=e.defer();return t.query(a,function(e,t){o=t()}).$promise.then(function(e){c.actions.list=e,c.actions.bucketFn=n,c.actions.buckets=n(e),i.resolve()},function(e){console.log("ERROR-> ",e),i.reject()}),i.promise};return angular.extend(c,{actions:{list:[],buckets:[]},mode:{code:"byform"},totalItems:{count:0},firstItem:{number:0},lastItem:{number:0},getById:f,getByForm:g,getByTime:p,save:d,find:l,setLocationId:function(e){s=e},update:m}),c}]),angular.module("fw-common").factory("$fw.common.rest.lookCalendarType",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/calendar/lookeventtype",o=e(r,{},{});return o}]),angular.module("fw-common").factory("$fw.common.rest.calendarEvents",["$resource","$fwConfig","$fw.core.httpPaginationInterceptor","$fw.common.rest.mediaLinkFactory","$fw.common.rest.locationFilterFactory",function(e,t,r,o,a){var n=t.urls.svcBase+"/service/calendar/:type/event/:eventId",i=t.urls.svcBase+"/service/calendar/:type/event/containing?",u=t.urls.svcBase+"/service/calendar/:type/event/clone/:eventId",s=n+"/view/:dateInt",c=t.urls.svcBase+"/service/calendar/:type/event/card/:cardId/event/:eventId",l={};l[t.interceptorConfig.watchedHeaders["FW-Busy-Request"]]=!1;var d=e(n,{type:"@type",eventId:"@eventId",dateInt:"@dateInt"},{update:{method:"PUT",transformRequest:function(e){return delete e.yearMap,angular.toJson(e)}},cloneEvent:{url:u,method:"GET"},acknowledge:{url:s,method:"POST",isArray:!1},getAknowledgement:{url:s,isArray:!1,method:"GET"},find:{url:i,isArray:!0,method:"GET",headers:l},getForCard:{url:c,isArray:!1,method:"GET"}});return angular.extend(d.prototype,{$fwMediaLinkFactory:o(n),$fwLocationFilter:a(n,function(e){return{eventId:e.id,type:"OPS"}})}),d}]),angular.module("fw-common").factory("$fw.common.rest.eventGuidelines",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/calendar/lookeventtype/guidelines",o=e(r,{},{});return o}]),angular.module("fw-common").factory("$fw.common.resource.userBadge",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/user/:userId/badge";return e(r,{userId:"@userId"})}]),angular.module("fw-common").constant("BadgeHolderType",{user:"user",location:"location"}).constant("BadgeCategory",{training:"training",certification:"certification",merit:"merit",group:"group",external:"external",other:"other"}).factory("$fw.common.rest.lookBadge",["$resource","$fwConfig",function(e,t){function r(){return this.mediaLinks.length>0?t.urls.cdnBaseSecure+this.mediaLinks[0].media.resourceId:void 0
}var o=t.urls.svcBase+"/lookbadge/:holderType/:id",a={holderType:"@holderType",id:"@id"},n=e(o,a,{update:{method:"PUT"}});return angular.extend(n.prototype,{getBadgeImageUrl:r}),n}]),angular.module("fw-common").constant("BadgeStatus",{Active:"Active",Revoked:"Revoked",Expired:"Expired",All:"All"}).factory("$fw.common.rest.badgeFactory",["$resource","$fwConfig","BadgeHolderType",function(e,t){function r(e){return{id:e.id}}function o(o,n,i){var u=(angular.isDefined(n)?n:a)+"/badge";return function(){var a=(i||r)(this);if(!this.hasOwnProperty(this.fwBadge)){this.badgeHolderType=o,this.fwBadge=e(u,a,{one:{method:"GET",url:u+"/:badgeId",params:{badgeId:"@badgeId",status:"Active"}},award:{method:"POST",url:u+"/:lookBadgeId",params:{lookBadgeId:"@badge.id",payload:null}},revoke:{method:"DELETE",url:u+"/:badgeId",params:{badgeId:"@id"}},update:{method:"PUT",url:u+"/:badgeId",params:{badgeId:"@id"}}});var n=function(){return this.badge.mediaLinks.length>0?t.urls.cdnBaseSecure+this.badge.mediaLinks[0].media.resourceId:void 0};angular.extend(this.fwBadge.prototype,{getBadgeImageUrl:n})}return this.fwBadge}}var a=t.urls.svcBase+"/:holderType/:holderId";return o}]),angular.module("fw-common").factory("$fw.common.rest.userFilterFactory",["$resource",function(e){function t(e){return{id:e.id}}function r(r,o){return function(){var a=r+"/userfilters/:filterId",n=(o||t)(this),i=angular.extend({},n,{filterId:"@id"}),u={save:{method:"PUT",isArray:!0}};return e(a,i,u)}}return r}]),angular.module("fw-common").factory("$fw.common.rest.prdsheet.lookMenuItem",["$resource","$fwConfig","$fw.common.rest.locationFilterFactory",function(e,t,r){var o=t.urls.svcBase+"/prdnsheets/menuitems/:menuItemId",a=o+"/all",n=e(o,{menuItemId:"@menuItemId"},{create:{method:"POST"},update:{method:"PUT"},getAll:{method:"GET",url:a,isArray:!0},markDeleted:{method:"DELETE"}});return angular.extend(n.prototype,{$fwLocationFilter:r(o,function(e){return{menuItemId:e.id}})}),n}]),angular.module("fw-common").factory("$fw.common.rest.mediaLinkFactory",["$resource",function(e){function t(e){return{id:e.id,mediaId:e.mediaId,caption:e.caption}}function r(r,o){return function(){var a=r+"/media/:mediaId",n=(o||t)(this),i=angular.extend({},n,{mediaId:"@mediaId",id:"@id",caption:"@caption"}),u={caption:{isArray:!0,url:a+"/caption",method:"PUT"},tag:{isArray:!1,url:a+"/tag",method:"PUT"},"delete":{method:"DELETE",isArray:!0},save:{method:"POST",transformRequest:function(e){var t=angular.copy(e);t.media=e.media;var r=new FormData;if(t.media&&t.media.length>0)for(var o=0;o<t.media.length;o++)t.media[o].blob?r.append("media",t.media[o].blob,t.media[o].filename):r.append("media",t.media[o]),t.media[o].caption=t.media[o].caption||t.media[o].filename;return r},headers:{"Content-Type":void 0}}};return e(a,i,u)}}return r}]),angular.module("fw-common").factory("$fw.common.rest.lookMenuItem",["$resource","$fwConfig","$fw.common.rest.locationFilterFactory",function(e,t,r){var o=t.urls.svcBase+"/log/lookmenuitem/:menuItemId",a=o+"/all",n=e(o,{menuItemId:"@menuItemId"},{update:{method:"PUT",transformRequest:function(e){return e.hasOwnProperty("_searchMeta")&&delete e._searchMeta,angular.toJson(e)}},getAllForLocation:{method:"GET",isArray:!0,url:o+"/location/:locationId"},getAll:{method:"GET",url:a,isArray:!0}});return angular.extend(n.prototype,{$fwLocationFilter:r(o,function(e){return{menuItemId:e.id}})}),n}]),angular.module("fw-common").factory("$fw.common.rest.lookMenuItemGroup",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/log/lookmenugroup",o=e(r,{},{getAll:{method:"GET",url:r,isArray:!0}});return o}]),angular.module("fw-common").factory("$fw.common.rest.lookLocationMenuItem",["$resource","$fwConfig","$fw.common.rest.locationFilterFactory",function(e,t,r){var o=t.urls.svcBase+"/service/log/location/:locationId/menuitem",a=o+"/:menuItemId",n=e(a,{locationId:"@locationId",menuItemId:"@menuItemId"},{update:{method:"PUT"},getAll:{method:"GET",isArray:!0,url:o},search:{method:"GET",url:o+"/search",isArray:!0},listToAdd:{method:"GET",url:o+"/listToAdd",isArray:!0}});return angular.extend(n.prototype,{$fwLocationFilter:r(a,function(e){return{menuItemId:e.id}})}),n}]),angular.module("fw-common").factory("$fw.common.rest.routine",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/routine/:locationId/:date",o=e(r,{locationId:"@locationId",date:"@date",taskId:"@taskId",locationRoutineId:"@locationRoutineId"},{update:{method:"PUT"},getAction:{url:r+"/task/:taskId/action",method:"GET",transformResponse:function(e,t){return{locationUri:t("Location")}}},saveAction:{url:r+"/task/:taskId/action",method:"POST",transformResponse:function(e,t){return{locationUri:t("Location")}}},getLocationTasks:{url:t.urls.svcBase+"/routine/:locationRoutineId/looktask/:taskId",method:"GET",isArray:!0},getLookTasks:{url:r+"/looktask",method:"GET"}});return o}]),angular.module("fw-common").factory("$fw.location.rest.service",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/location/:locationId",o=r+"/dagChangeImpact/:dagId/:newDagId",a=t.urls.svcBase+"/location/code/:locationCd",n=e(r,{locationId:"@locationId",dagId:"@dagId",newDagId:"@newDagId",locationCd:"@locationCd"},{dagChangeImpact:{method:"GET",url:o,isArray:!1},locationByCode:{method:"GET",url:a,isArray:!1}});return n}]),angular.module("fw-common").factory("$fw.common.rest.locationMenuItems",["$resource","$fwConfig","$fw.core.httpPaginationInterceptor",function(e,t,r){var o=t.urls.svcBase+"/log/location/:locationId/menuitem/:menuItemId",a=o+"/listToAdd",n=e(o,{locationId:"@locationId",menuItemId:"@menuItemId"},{search:{method:"GET",url:t.urls.svcBase+"/log/location/:locationId/menuitem/search",isArray:!0,interceptor:{response:r.response}},update:{method:"PUT"},listToAdd:{method:"GET",url:a,isArray:!0,interceptor:{response:r.response}}});return n}]),angular.module("fw-common").factory("$fw.common.rest.locationMenuItemSchedule",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/locationMenuItem/:locationMenuItemId/schedule/:scheduleId",o=e(r,{locationMenuItemId:"@locationMenuItemId",scheduleId:"@id"},{update:{method:"PUT"}});return o}]),angular.module("fw-common").factory("$fw.common.rest.locationFilterFactory",["$resource",function(e){function t(e){return{id:e.id}}function r(r,o){return function(){var a=r+"/locationfilters/:filterId",n=(o||t)(this),i=angular.extend({},n,{filterId:"@id"}),u={save:{method:"PUT",isArray:!0}};return e(a,i,u)}}return r}]),angular.module("fw-common").factory("$fw.common.rest.locationEquipment",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/equipment/location/:id/equipment/:equipmentId",o=e(r,{id:"@id",equipmentId:"@equipmentId"});return o}]),angular.module("fw-common").factory("$fw.common.rest.learner",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/lms/learners/:learnerId",o=e(r,{earnerId:"@learnerId"},{});return o}]),angular.module("fw-common").factory("$fw.common.service.rest.learner.courseware.dictionary",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/lms/learners/:learnerId/programs/:id",o=r+"/topics/:topicId",a=o+"/courses",n=t.urls.svcBase+"/service/lms/learners/:learnerId/courses/force",i=t.urls.svcBase+"/service/lms/learners/:learnerId/reconcile",u=t.urls.svcBase+"/service/lms/learners/:learnerId",s=e(r,{learnerId:"@learnerId",id:"@id",topicId:"@topicId"},{programs:{isArray:!0},topics:{isArray:!0,method:"GET",url:o},courses:{isArray:!0,method:"GET",url:a},reconcile:{isArray:!1,method:"PUT",url:i},force:{isArray:!1,url:n,method:"POST"},getLearner:{method:"GET",url:u}});return s}]),angular.module("fw-common").factory("$fw.user.resource.LearnerCoursewareBulk",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/lms/learners/courses/forcelearners",o={};o[t.interceptorConfig.watchedHeaders["FW-Busy-Request"]]=!1;var a={createMissing:"@createMissing"},n={update:{method:"POST",headers:o}};return e(r,a,n)}]),angular.module("fw-common").factory("$fw.common.service.rest.courseware.dictionary",["$resource","$fwConfig",function(e,t){var r=t.urls.svcBase+"/service/lms/courseware/programs/:id",o=r+"/topics/:topicId",a=o+"/courses",n=t.urls.svcBase+"/service/lms/courseware/courses/:courseCd",i=e(r,{id:"@id",topicId:"@topicId",courseCd:"@courseCd"},{programs:{isArray:!0},topics:{isArray:!0,method:"GET",url:o},courses:{isArray:!0,method:"GET",url:a},course:{method:"GET",url:n,isArray:!1}});return i}]),angular.module("fw-common").factory("$fw.common.rest.commentFactory",["$resource",function(e){function t(e){return{id:e.id}}function r(r,o){return function(){var a=r+"/comment/:commentId",n=(o||t)(this),i=angular.extend({},n,{commentId:"@id"}),u={update:{method:"PUT",isArray:!1}};return e(a,i,u)}}return r}]),angular.module("fw-common").factory("$fw.common.rest.actionItemLinkFactory",["$resource",function(e){function t(e){return{id:e.id}}function r(r,o){return function(){var a=r+"/actions/:actionLinkId",n=(o||t)(this),i=angular.extend({},n,{actionLinkId:"@actionLinkId",entityId:"@entityId"}),u={assign:{method:"POST"},query:{isArray:!0},unassign:{method:"DELETE",isArray:!0}};return e(a,i,u)}}return r}]),angular.module("fw-common").service("$fw.logs.utils",["$fw.logs.countService","$fw.logs.rest.logAction","$fw.logs.category.rest.log",function(e,t,r){function o(t,r,a){return t.map(function(t){if(t.children.length>0){var n=o(t.children,!0,a),i=e.getCounts(n,!0,"attributes").attrCnt;t.children=i>0?n:[]}return r===!0&&(t.isChild=!0),t.attributes=t.attributes.filter(function(e){return!!a[e.id]}).map(function(e){return angular.merge(e,a[e.id]),e}),t})}function a(e){var r={},o=Object.keys(e).map(function(t){return e[t].id});return t.mapActions({attributeIds:o}).$promise.then(function(e){return angular.forEach(e,function(e,t){e&&e.length>0&&(r[t]=e[0].actionItem)}),r})}function n(e){return Object.keys(e).map(function(t){return e[t]}).reduce(function(e,t){return e[t.id]=!1,e},{})}function i(e,t){return e[t]?(e[t]instanceof r||(e[t]=new r(e[t])),e[t]):void 0}function u(e){return{id:e.id,lookAttribute:e.lookAttribute,value:e.value}}return{prep:o,getActionVisibility:n,attributeToAction:a,getCatInstance:i,attrToPayload:u}}]),angular.module("fw-common").provider("fw.common.GoogleAnalytics",[function(){function e(e,t){var r=t?t:!1;if(e){var o="https://www.google-analytics.com/"+(r?"analytics_debug.js":"analytics.js");!function(e,t,r,o,a,n,i){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,n=t.createElement(r),i=t.getElementsByTagName(r)[0],n.async=1,n.src=o,i.parentNode.insertBefore(n,i)}(window,document,"script",o,"ga"),ga("create",e,"auto")}}return{create:e,$get:[function(){return{create:e}}]}}]),angular.module("fw-common").service("$fw.foundations.utils",["$q","$fwConfig","$fw.common.rest.lookBadge","$fw.ctr.rest.crt","$fw.foundations.assessment.utils",function(e,t,r,o,a){function n(e,t,r){try{return e.learning[t][r]}catch(o){return null}}function i(e,t,r){var o=A[t],a=n(e,o.unit,o.unitCd);return null==a?0:a[r]}function u(e,t){return i(e,t,"tiaCompletion")}function s(e,t){return i(e,t,"completion")}function c(e,t){return i(e,t,"score")}function l(e,t){return a.canWriteLog(e,t)}function d(e,t){return a.canWriteLog(e,t)}function m(e,t){return a.canWriteLog(e,t)}function f(e,t,r,o){var a=!(angular.isDefined(t.badges)&&angular.isDefined(v(t.badges)[r]));return a=a&&l(e,r),a=a&&angular.isDefined(o)&&o.score.pass}function g(e,t,r,o){return angular.isDefined(o[r])?a.canReadLog():m(e,r)&&100===s(t,r)&&100===u(t,r)}function p(){var e={holderType:"user"};return r.query(e).$promise}function y(e){return e.reduce(function(e,t){return t.payload.topicCd&&T.indexOf(t.payload.topicCd)>-1&&(e[t.payload.topicCd]=t),e},{})}function v(e){return e.reduce(function(e,t){return t.payloadType==$&&(e[t.payload.shift]=t),e},{})}function h(e,t,r){var o=e.filter(function(e){return e.payloadType==$&&e.payload.shift==t&&e.payload.level==r?!0:void 0});return o.length>0?o[0]:null}function w(e){return o.get({userId:e.id}).$promise.then(function(e){return angular.isDefined(e.holder)})}function I(t,r,o){return l(t,o)?w(t).then(function(e){return e?"Tier1":"Tier2"}).then(function(t){return p().then(function(a){var n=h(a,o,t);if(null!=n){var i={badge:n,payload:n.payload};return r.$fwBadge().award(i).$promise}return e.reject()})}):e.reject()}var $="frameworks.lms.learner.badge.ShiftCertificationBadgePayload",T=["BASIC","SH_CTRL","CLOSING"],A={MIDDAY:{unit:"topics",unitCd:T[1]},OPENING:{unit:"topics",unitCd:T[1]},CLOSING:{unit:"topics",unitCd:T[2]}};return{SHIFT_BADGE_PAYLOAD:$,FOUNDATIONS_TOPICS:T,SHIFTS:A,certifiable:f,assessable:g,canCertify:l,canRevoke:d,certify:I,getUnit:n,getScore:c,getCompletion:s,getTiaCompletion:u,getShiftBadges:v,getTopicBadges:y}}]),angular.module("fw-common").service("$fw.foundations.assessment.utils",["$fw.foundations.rest.js","$rootScope","$filter","$mdToast","$fw.logs.utils",function(e,t,r,o,a){function n(e){return"FRAMEWORKS"===e.role?!0:e.hasOneRight("MIT_WRITE")}function i(e){return t.currentUser.id===e}function u(){return t.currentUser.hasOneRight("MIT_SEARCH")}function s(){return t.currentUser.hasOneRight("MIT_READ")}function c(e,t){return n(e,t)}function l(e,t,r,o){return e&&n(r,o)&&!t}function d(e,t,r,o){return!e&&n(r,o)&&!t}function m(e,t,r,o){return e&&!t&&n(r,o)}function f(e){return e&&s()}function g(e,t){var t=t||[];return e.forEach(function(e){e.children.length>0&&g(e.children,t),e.attributes.forEach(function(e){t.push(a.attrToPayload(e))})}),t}function p(t,r,o){var a=g(t);return e.updateAttr({userId:!isNaN(+o)&&o||o.userId,shiftCd:r},a).$promise}function y(r,o){var a={completedDateTime:Date.now(),completedUserId:t.currentUser.id,status:"COMPLETE"};return e.completeEval({userId:!isNaN(+o)&&o||o.userId,shiftCd:r},a).$promise}function v(t,r,o,a,n){return e.updateAction({actionId:r,userId:!isNaN(+a)&&a||a.userId,shiftCd:n}).$promise}function h(t,r){return e.deleteEval({userId:!isNaN(+t)&&t||t.userId,shiftCd:r}).$promise}function w(e){o.show(o.simple().content(T(e)).position("bottom right").hideDelay(3e3).parent(angular.element(document.getElementById("assessment"))))}function I(e){return Object.keys(e).filter(function(e){return!isNaN(+e)}).map(function(t){return e[t]})}function $(e,t){return T(t?"foundations.status.complete":0===e?"foundations.status.new":"foundations.status.inProgress")}var T=r("translate"),A="U_S",k="SCALE_1_4",C="RADIO_1_4",b=[1,2,3,4];return{save:p,complete:y,act:v,reassess:h,canComplete:m,canScore:d,canWriteLog:n,canReadLog:s,canSearch:u,canViewSummary:f,shouldShowReassess:l,isOwnAssessment:i,canAct:c,toastIt:w,getStatus:$,filterAttrMap:I,ATTR_BOOL:A,ATTR_DROPDOWN:k,ATTR_RADIO:C,RANGE:b}}]),angular.module("fw-common").service("$fw.crt.utils",["$q","$fw.ctr.rest.crt","$fw.common.rest.lookBadge","$fw.foundations.assessment.utils",function(e,t,r){function o(){var e={holderType:"user"};return r.query(e).$promise}function a(e){return m(e,A)}function n(e){return m(e,k)}function i(e){return e.hasOneRight("CRT_READ")}function u(e,t,r){return!e&&y(r)&&!t}function s(e,t,r){return e&&!t&&y(r)}function c(e,t){return e&&i(t)}function l(e){return y(e)}function d(e,t,r){return e&&y(r)&&!t}function m(e,t){if(null!=e){var r=e.filter(function(e){return e.payloadType==t});return r.length>0?r[0]:void 0}}function f(e,t,r){try{return e.learning[t][r]}catch(o){return null}}function g(e,t,r,o){var t=f(e,t,r);return null==t?0:t[o]}function p(e){return g(e,"courses","BK039","completion")}function y(e){return e.hasOneRight("CRT_WRITE")}function v(e){return y(e)}function h(e,t,r){var o=!(angular.isDefined(t.badges)&&angular.isDefined(a(t.badges)));return o=o&&w(e),o=o&&angular.isDefined(r)&&r.score.pass}function w(e){return y(e)}function I(t,r){return w(t,r)?o().then(function(t){var o=a(t),i=n(r.badges);if(null!=o){null!=i&&i.$revoke();var u={badge:o,payload:o.payload};return r.$fwBadge().award(u).$promise}return e.reject()}):e.reject()}function $(e){var t=!0;try{t=t&&100==e.learning.programs.TM_TRAINING.completion,t=t&&e.badges.length>=3;var r=e.badges.reduce(function(e,t){return"frameworks.lms.learner.badge.ShiftCertificationBadgePayload"==t.payload["@class"]&&(e[t.payload.shift]=t),e},{});t=t&&r.MIDDAY&&r.OPENING&&r.CLOSING}catch(o){t=!1}return t}function T(e,t,r){return e&&t&&r?t&&t[r.userId]&&t[r.userId].CRT?i(e):v(e)&&100==p(r):!1}var A="frameworks.crt.badge.TrainerCertificationPayload",k="frameworks.crt.badge.TrainerNomineePayload";return{getCrtCourseCompletion:p,certifiable:h,assessable:T,certify:I,getCrtBadge:a,canNominate:$,canStartLog:v,canWriteLog:y,canReadLog:i,shouldShowReassess:d,canAct:l,canViewSummary:c,canComplete:s,canScore:u}}]),angular.module("fw-common").factory("$fw.common.lms.service.courseware.dictionary",["$q","$fw.common.service.rest.courseware.dictionary","$fw.common.service.rest.learner.courseware.dictionary",function(e,t,r){function o(t){var o=e.defer();return r.programs({learnerId:t}).$promise.then(function(e){o.resolve(e)}),o.promise}function a(){var r=e.defer(),o={};return t.programs().$promise.then(function(r){var a={};return r.forEach(function(e){var r=e.programCd;o[r]=JSON.parse(angular.toJson(e)),a[r]=t.topics({id:e.programCd}).$promise}),e.all(a)}).then(function(r){var a={};return angular.forEach(r,function(e,r){o[r].topics={},e.forEach(function(e){o[r].topics[e.topicCd]=JSON.parse(angular.toJson(e)),a[r+"|"+e.topicCd]=t.courses({id:r,topicId:e.topicCd}).$promise})}),e.all(a)}).then(function(e){return angular.forEach(e,function(e,t){var r=/^(.+)\|(.+)$/.exec(t),a=r[1],n=r[2],i={};e=JSON.parse(angular.toJson(e));for(var u=0;u<e.length;u++){var s=e[u];i[s.courseCd]=e[u]}o[a].topics[n].courses=i}),console.log("returning ",o),r.resolve(o)}),r.promise}function n(t){var o=e.defer(),a={};return r.programs({learnerId:t}).$promise.then(function(o){var n={};return o.forEach(function(e){var o=e.program;a[o]=JSON.parse(angular.toJson(e)),n[o]=r.topics({id:e.program,learnerId:t}).$promise}),e.all(n)}).then(function(o){var n={};return angular.forEach(o,function(e,o){a[o].topics={},e.forEach(function(e){a[o].topics[e.topic]=JSON.parse(angular.toJson(e)),n[o+"|"+e.topic]=r.courses({id:o,learnerId:t,topicId:e.topic}).$promise})}),e.all(n)}).then(function(e){return angular.forEach(e,function(e,t){var r=/^(.+)\|(.+)$/.exec(t),o=r[1],n=r[2],i={};e=JSON.parse(angular.toJson(e));for(var u=0;u<e.length;u++){var s=e[u];i[s.cd]=e[u]}a[o].topics[n].courses=i}),o.resolve(a)}),o.promise}function i(t){var o=e.defer();return r.reconcile({learnerId:t}).$promise.then(function(e){o.resolve(e)}),o.promise}function u(t,o,a,n,i){var u=e.defer();return r.force({learnerId:a,userId:o,reasonCd:n,reason:i},t).$promise.then(function(e){u.resolve(e)}),u.promise}var s=this;return angular.extend(s,{getCoursewareDictionary:a,getLearnerCoursewareDictionary:n,reconcile:i,force:u,getLearnerPrograms:o}),s}]),angular.module("fw-common").factory("$fw.common.queueService",["$injector",function(e){return function(){return e.instantiate(Queue)}}]),angular.module("fw-common").service("fw.common.mediaDeleteQueue",["$rootScope","$q",MediaDeleteQueue]),angular.module("fw-common").service("$fw.opslink.mandatoryCardsService",["$rootScope","$q",MandatoryCardsService]),angular.module("fw-common").service("$fw.common.utilities",[function(){function e(e){var t=null;if(angular.isDate(e)){var r=e.getFullYear(),o=e.getMonth()+1,a=e.getDate();t=1e4*r+100*o+a}return t}function t(e){if(!e)return new Date;var t=e.toString(),r=/(\d{4})(\d{2})(\d{2})/;return new Date(t.replace(r,"$1/$2/$3"))}function r(e){return this.convertDateToUrlParameter(new Date(e))}function o(e){return this.dateToStringParam(new Date(e))}function a(e){var r="object"!=typeof e?t(e):e,o=new Date;r=r.getTime()/1e3,o=o.setHours(0,0,0,0)/1e3;var a=o-r;return 31622400>a}function n(e,t){t=t||1;var r=new Date(e);return r.setDate(e.getDate()+t),r}function i(e,t){t=t||1;var r=new Date(e);return r.setDate(e.getDate()-t),r}return{convertDateToUrlParameter:e,convertUrlDateToDateObject:t,millisToDateInt:r,millisToDateStr:o,isLogDateWithinRange:a,addDays:n,subtractDays:i}}]),angular.module("fw-common").factory("fw.common.desireQueue",["$q",DesireQueue]),angular.module("fw-common").factory("$fw.logs.countService",[function(){function e(e,t,r,o){function a(e){e.value&&(i++,e.id&&(u[e.id]=1)),n++}var n=0,i=0,u={};return t?!function s(e){e.forEach(function(t){o&&t.hasOwnProperty(o)&&(e[o]=s(t[o])),r&&t.hasOwnProperty(r)&&t[r].forEach(a)})}(e):e.forEach(a),{attrCnt:n,checkedCnt:i,checkedAttrs:u}}return{getCounts:e}}]),angular.module("fw-common").factory("$fw.common.bubbleSort",[function(){function e(e,t){t=t||function(e,t){return e>t};var r;do{r=!1;for(var o=0;o<e.length-1;o++)if(t(e[o],e[o+1])){var a=e[o];e[o]=e[o+1],e[o+1]=a,r=!0}}while(r);return e}return{sort:e}}]),angular.module("fw-common").factory("$fw.common.arrayIncludes",[function(){function e(e,t){if(null==e)throw new TypeError("You gotta send in an array!");var r=Object(e),o=parseInt(r.length,10)||0;if(0===o)return!1;var a,n=parseInt(arguments[1],10)||0;n>=0?a=n:(a=o+n,0>a&&(a=0));for(var i;o>a;){if(i=r[a],angular.equals(t,i)||t!==t&&i!==i)return!0;a++}return!1}return{includes:e}}]),angular.module("fw-common").filter("fwDateIntToDate",["$filter","$fw.common.utilities",function(e,t){function r(e){return t.convertUrlDateToDateObject(e)}return r}]),angular.module("fw-common").directive("dateToDateInt",["$fw.common.utilities",function(e){return{require:"ngModel",link:function(t,r,o,a){a.$parsers.push(function(t){return e.convertDateToUrlParameter(t)})}}}]);